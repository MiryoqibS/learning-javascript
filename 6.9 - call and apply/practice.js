/*
== Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ 1 Ñ ÑÐ°Ð¹Ñ‚Ð° ==
Ð”ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€-ÑˆÐ¿Ð¸Ð¾Ð½
Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ spy(func), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ Ð¾Ð±Ñ‘Ñ€Ñ‚ÐºÑƒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ð²ÑÐµ Ð²Ñ‹Ð·Ð¾Ð²Ñ‹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð² ÑÐ²Ð¾Ñ‘Ð¼ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ðµ calls.

ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð² Ð´Ð¾Ð»Ð¶ÐµÐ½ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑ‚ÑŒÑÑ ÐºÐ°Ðº Ð¼Ð°ÑÑÐ¸Ð² Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð².

ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:

function work(a, b) {
  alert( a + b ); // Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¸Ð»Ð¸ Ð¼ÐµÑ‚Ð¾Ð´
}

work = spy(work);

work(1, 2); // 3
work(4, 5); // 9

for (let args of work.calls) {
  alert( 'call:' + args.join() ); // "call:1,2", "call:4,5"
}
P.S.: Ð­Ñ‚Ð¾Ñ‚ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¸Ð½Ð¾Ð³Ð´Ð° Ð¿Ð¾Ð»ÐµÐ·ÐµÐ½ Ð´Ð»Ñ ÑŽÐ½Ð¸Ñ‚-Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ. Ð•Ð³Ð¾ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð°Ñ Ñ„Ð¾Ñ€Ð¼Ð° â€“ sinon.spy â€“ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ÑÑ Ð² Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐµ Sinon.JS.
*/

function work(a, b) {
    console.log(a + b); // Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¸Ð»Ð¸ Ð¼ÐµÑ‚Ð¾Ð´
}

function spy(func) {
    function wrapper(...args) {
        wrapper.calls.push(args);
        return func.apply(this, args);
    }

    wrapper.calls = [];
    return wrapper;
}

work = spy(work);

/*
== Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ 2 Ñ ÑÐ°Ð¹Ñ‚Ð° ==
Ð—Ð°Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€
Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ delay(f, ms), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð·Ð°Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð² f Ð½Ð° ms Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:

function f(x) {
    alert(x);
}

// ÑÐ¾Ð·Ð´Ð°Ñ‘Ð¼ Ð¾Ð±Ñ‘Ñ€Ñ‚ÐºÐ¸
let f1000 = delay(f, 1000);
let f1500 = delay(f, 1500);

f1000("test"); // Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ "test" Ð¿Ð¾ÑÐ»Ðµ 1000 Ð¼Ñ
f1500("test"); // Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ "test" Ð¿Ð¾ÑÐ»Ðµ 1500 Ð¼Ñ
Ð”Ñ€ÑƒÐ³Ð¸Ð¼Ð¸ ÑÐ»Ð¾Ð²Ð°Ð¼Ð¸, delay(f, ms) Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚ f Ñ Â«Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ Ð½Ð° ms Ð¼ÑÂ».

Ð’ Ð¿Ñ€Ð¸Ð²ÐµÐ´Ñ‘Ð½Ð½Ð¾Ð¼ Ð²Ñ‹ÑˆÐµ ÐºÐ¾Ð´Ðµ f â€“ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ñ Ð¾Ð´Ð½Ð¸Ð¼ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð¼, Ð½Ð¾ Ð²Ð°ÑˆÐµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð¸ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ this.
*/

const delay = (func, delay) => {
    return function (...args) {
        const context = this;
        setTimeout(() => {
            return func.apply(context, args);
        }, delay);
    };
};

function f(x) {
    console.log(x);
}

// ÑÐ¾Ð·Ð´Ð°Ñ‘Ð¼ Ð¾Ð±Ñ‘Ñ€Ñ‚ÐºÐ¸
let f1000 = delay(f, 1000);
let f1500 = delay(f, 1500);

f1000("test"); // Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ "test" Ð¿Ð¾ÑÐ»Ðµ 1000 Ð¼Ñ
f1500("test"); // Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ "test" Ð¿Ð¾ÑÐ»Ðµ 1500 Ð¼Ñ

const user = {
    name: "ÐœÐ¸Ñ€Ñ‘ÐºÑƒÐ±",
    say(greeting) {
        console.log(`${greeting}, I'm ${this.name}`);
    },
};

// Ð Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð·Ð°Ð´ÐµÑ€Ð¶Ð¸Ð¼ ÑÑ‚Ð¾:
user.say = delay(user.say, 1000);

user.say("Hi"); // ðŸ‘‰ "Hi, I'm ÐœÐ¸Ñ€Ñ‘ÐºÑƒÐ±"

/*
== Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ 3 Ñ ÑÐ°Ð¹Ñ‚Ð° ==
Ð¡Ð¾Ð·Ð´Ð°Ð¹ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¾Ñ‚ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°ÐµÑ‚ Ð²Ñ‹Ð·Ð¾Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ f Ð´Ð¾ Ñ‚ÐµÑ… Ð¿Ð¾Ñ€, Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¿Ñ€Ð¾Ð¹Ð´Ñ‘Ñ‚ ms Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´ Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ð°.
Ð•ÑÐ»Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÑŽÑ‚ Ð¼Ð½Ð¾Ð³Ð¾ Ñ€Ð°Ð· Ð¿Ð¾Ð´Ñ€ÑÐ´ â€” Ð¾Ð½Ð° Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ ÑÑ€Ð°Ð·Ñƒ.
ÐžÐ½Ð° Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·, Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð°ÑƒÐ·Ñ‹, Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¼Ð¸ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð¼Ð¸.

f("a");                  // Ð¸Ð³Ð½Ð¾Ñ€
setTimeout(() => f("b"), 200);  // Ð¸Ð³Ð½Ð¾Ñ€
setTimeout(() => f("c"), 500);  // Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑ‚Ð¾Ñ‚ â€” Ñ‡ÐµÑ€ÐµÐ· 1000 Ð¼Ñ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ð°
ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ:
Ð§Ð°ÑÑ‚Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ñ‡Ð°ÑÑ‚Ð¾ â€” Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¿Ñ€Ð¸ Ð²Ð²Ð¾Ð´Ðµ Ñ‚ÐµÐºÑÑ‚Ð°, Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ð¸ Ð¼Ñ‹ÑˆÐ¸ Ð¸ Ñ‚.Ð¿.
*/

const debounce = (func, delay) => {
    let timeoutId;

    return function(text) {
        clearTimeout(timeoutId);

        timeoutId = setTimeout(()=>{
            func.apply(this, arguments)
        }, delay)
    };
}
let f2 = (x) => console.log(x);
let debouncedF = debounce(f2, 1000);

debouncedF("a");
setTimeout(() => debouncedF("b"), 200);
setTimeout(() => debouncedF("c"), 500);

/*
== Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ 4 Ñ ÑÐ°Ð¹Ñ‚Ð° ==
Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ throttle(f, ms), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñƒ Ð²Ñ‹Ð·Ð¾Ð²Ð¾Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ f. ÐžÐ±Ñ‘Ñ€Ñ‚ÐºÐ° Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ f Ð½Ðµ Ñ‡Ð°Ñ‰Ðµ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ€Ð°Ð·Ð° Ð·Ð° ms Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´.

ÐžÑ‚Ð»Ð¸Ñ‡Ð¸Ðµ Ð¾Ñ‚ debounce:

debounce Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð· Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° Ð±ÐµÐ·Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ.
throttle Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾, Ð½Ð¾ Ð½Ðµ Ñ‡Ð°Ñ‰Ðµ, Ñ‡ÐµÐ¼ Ð·Ð°Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð».

function f(a) {
    console.log(a);
}

// Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ Ð´ÐµÐºÐ¾Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ, Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÑŽÑ‰ÑƒÑŽ f Ð½Ðµ Ñ‡Ð°Ñ‰Ðµ, Ñ‡ÐµÐ¼ Ñ€Ð°Ð· Ð² 1000 Ð¼Ñ
let f1000 = throttle(f, 1000);

f1000(1); // Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ 1 ÑÑ€Ð°Ð·Ñƒ
f1000(2); // Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ, Ñ‚.Ðº. 1000 Ð¼Ñ ÐµÑ‰Ñ‘ Ð½Ðµ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾
f1000(3); // Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ

// ÐŸÐ¾ÑÐ»Ðµ 1000 Ð¼Ñ:
// Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ f(3) Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¼Ð¸ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð¼Ð¸
*/

const throttle = (func, ms) => {
    let call = false;

    return function() {
        if (!call) {
            func.apply(this, arguments);

            call = true;

            setTimeout(()=>{
                call = false;
            }, ms)
        }
    };
};

function f(a) {
    console.log(a);
}

// Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ Ð´ÐµÐºÐ¾Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ, Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÑŽÑ‰ÑƒÑŽ f Ð½Ðµ Ñ‡Ð°Ñ‰Ðµ, Ñ‡ÐµÐ¼ Ñ€Ð°Ð· Ð² 1000 Ð¼Ñ
let f1550 = throttle(f, 1550);

f1550(1); // Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ 1 ÑÑ€Ð°Ð·Ñƒ
f1550(2); // Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ, Ñ‚.Ðº. 1000 Ð¼Ñ ÐµÑ‰Ñ‘ Ð½Ðµ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾
f1550(3); // Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ


/*
== Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ 1 Ð¾Ñ‚ ChatGPT
Ð¡Ð¾Ð·Ð´Ð°Ð¹ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ uniqueArgs(func), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð±Ð¾Ñ€Ñ‹ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð², Ñ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼Ð¸ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ð»Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ.

ÐžÐ½ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¸Ñ… Ð² Ð¼Ð°ÑÑÐ¸Ð²Ðµ calls, ÐºÐ°Ðº Ð¸ Ð² Ð¿Ñ€Ð¾ÑˆÐ»Ð¾Ð¼ Ð·Ð°Ð´Ð°Ð½Ð¸Ð¸, Ð½Ð¾ Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ðµ Ð²Ñ‹Ð·Ð¾Ð²Ñ‹ Ñ Ñ‚ÐµÐ¼Ð¸ Ð¶Ðµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð¼Ð¸ (Ð² Ñ‚Ð¾Ð¼ Ð¶Ðµ Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ).

const decorated = uniqueArgs(anyFunction);
decorated(1, 2);      // Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ
decorated(3, 4);      // Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ
decorated(1, 2);      // Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ
decorated(2, 1);      // Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ, Ñ‚.Ðº. Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº Ð´Ñ€ÑƒÐ³Ð¾Ð¹

Ð’Ñ‹Ð·Ð¾Ð²Ñ‹ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð² decorated.calls
Ð¢Ð°Ð¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑŽ Ð¸ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹
ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒÑÑ Ð² Ð²Ð¸Ð´Ðµ Ð¼Ð°ÑÑÐ¸Ð²Ð° [a, b, ...]
*/

const anyFunction = () => {
    return 1;
};

const uniqueArgs = (func) => {
    function wrapper(...args) {
        for (const call of wrapper.calls) {
            if (String(call) == String(args)) {
                return call;
            };
        };

        wrapper.calls.push(args);
        return func.apply(this, args);
    }

    wrapper.calls = [];
    return wrapper;
};

const decorated = uniqueArgs(anyFunction);